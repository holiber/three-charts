{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///plugins/src/TrendsBeaconWidget/TrendsBeaconWidget.js","webpack:///webpack/bootstrap 4b867252af44e1a8fdfc?16ca","webpack:///./plugins/src/TrendsBeaconWidget/index.ts","webpack:///external \"three-charts\"?bed9","webpack:///./plugins/src/TrendsBeaconWidget/TrendsBeaconWidget.ts"],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_2__","modules","installedModules","__webpack_require__","moduleId","id","loaded","call","m","c","p","__export","hasOwnProperty","__extends","d","b","__","constructor","prototype","Object","create","Mesh","THREE","PlaneBufferGeometry","MeshBasicMaterial","three_charts_1","ANIMATION_TIME","ANIMATION_DELAY","TrendsBeaconWidget","_super","apply","arguments","getTrendWidgetClass","TrendBeacon","widgetName","TrendsWidget","chart","trendName","initObject","updatePosition","widgetIsEnabled","trendOptions","enabled","hasBeacon","type","TREND_TYPE","LINE","getObject3D","mesh","onTrendChange","animate","bindEvents","_this","bindEvent","onScroll","light","map","createTexture","transparent","setInitialState","add","segment","trend","segmentsManager","getEndSegment","state","animations","animation","stop","animationObject","scale","x","opacity","material","animationManager","withDelay","from","to","onTick","set","then","onDestroy","h","w","Utils","ctx","beginPath","arc","Math","PI","fillStyle","fill","onTransformationFrame","onSegmentsAnimate","trendsSegments","xVal","yVal","currentAnimationState","getOptions","endXVal","endYVal","endPointVector","screen","getPointOnChart","screenWidth","width","screenX","getScreenXByPoint","getPointByScreenX","position","y","TrendWidget"],"mappings":"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","file":"plugins/src/TrendsBeaconWidget/TrendsBeaconWidget.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"three-charts\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"three-charts\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"TrendsBeaconWidget\"] = factory(require(\"three-charts\"));\n\telse\n\t\troot[\"THREE_CHARTS\"] = root[\"THREE_CHARTS\"] || {}, root[\"THREE_CHARTS\"][\"TrendsBeaconWidget\"] = factory(root[\"three-charts\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"three-charts\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"three-charts\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"TrendsBeaconWidget\"] = factory(require(\"three-charts\"));\n\telse\n\t\troot[\"THREE_CHARTS\"] = root[\"THREE_CHARTS\"] || {}, root[\"THREE_CHARTS\"][\"TrendsBeaconWidget\"] = factory(root[\"three-charts\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(4));\r\n\n\n/***/ },\n/* 1 */,\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ },\n/* 3 */,\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __extends = (this && this.__extends) || function (d, b) {\r\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\t    function __() { this.constructor = d; }\r\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n\t};\r\n\tvar Mesh = THREE.Mesh;\r\n\tvar PlaneBufferGeometry = THREE.PlaneBufferGeometry;\r\n\tvar MeshBasicMaterial = THREE.MeshBasicMaterial;\r\n\tvar three_charts_1 = __webpack_require__(2);\r\n\tvar ANIMATION_TIME = 1000;\r\n\tvar ANIMATION_DELAY = 300;\r\n\t/**\r\n\t * widget adds blinking beacon on trends end\r\n\t * activated when trend.hasBeacon = true\r\n\t */\r\n\tvar TrendsBeaconWidget = (function (_super) {\r\n\t    __extends(TrendsBeaconWidget, _super);\r\n\t    function TrendsBeaconWidget() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    TrendsBeaconWidget.prototype.getTrendWidgetClass = function () {\r\n\t        return TrendBeacon;\r\n\t    };\r\n\t    TrendsBeaconWidget.widgetName = 'TrendsBeacon';\r\n\t    return TrendsBeaconWidget;\r\n\t}(three_charts_1.TrendsWidget));\r\n\texports.TrendsBeaconWidget = TrendsBeaconWidget;\r\n\tvar TrendBeacon = (function (_super) {\r\n\t    __extends(TrendBeacon, _super);\r\n\t    function TrendBeacon(chart, trendName) {\r\n\t        _super.call(this, chart, trendName);\r\n\t        this.initObject();\r\n\t        this.updatePosition();\r\n\t    }\r\n\t    TrendBeacon.widgetIsEnabled = function (trendOptions) {\r\n\t        return trendOptions.enabled && trendOptions.hasBeacon && trendOptions.type == three_charts_1.TREND_TYPE.LINE;\r\n\t    };\r\n\t    TrendBeacon.prototype.getObject3D = function () {\r\n\t        return this.mesh;\r\n\t    };\r\n\t    TrendBeacon.prototype.onTrendChange = function () {\r\n\t        this.updatePosition();\r\n\t        this.animate();\r\n\t    };\r\n\t    TrendBeacon.prototype.bindEvents = function () {\r\n\t        var _this = this;\r\n\t        _super.prototype.bindEvents.call(this);\r\n\t        this.bindEvent(this.chart.onScroll(function () { return _this.updatePosition(); }));\r\n\t    };\r\n\t    TrendBeacon.prototype.initObject = function () {\r\n\t        // add beacon\r\n\t        var light = this.mesh = new Mesh(new PlaneBufferGeometry(32, 32), new MeshBasicMaterial({ map: TrendBeacon.createTexture(), transparent: true }));\r\n\t        this.setInitialState();\r\n\t        // add dot\r\n\t        light.add(new Mesh(new PlaneBufferGeometry(5, 5), new MeshBasicMaterial({ map: TrendBeacon.createTexture() })));\r\n\t        this.segment = this.trend.segmentsManager.getEndSegment();\r\n\t    };\r\n\t    TrendBeacon.prototype.animate = function () {\r\n\t        var _this = this;\r\n\t        if (!this.chart.state.animations.enabled)\r\n\t            return;\r\n\t        if (this.animation)\r\n\t            this.animation.stop();\r\n\t        this.setInitialState();\r\n\t        var mesh = this.mesh;\r\n\t        var animationObject = {\r\n\t            scale: mesh.scale.x,\r\n\t            opacity: mesh.material.opacity\r\n\t        };\r\n\t        this.animation = this.chart.animationManager\r\n\t            .animate(ANIMATION_TIME)\r\n\t            .withDelay(ANIMATION_DELAY)\r\n\t            .from(animationObject)\r\n\t            .to({ scale: 1, opacity: 0 })\r\n\t            .onTick(function (animationObject) {\r\n\t            mesh.scale.set(animationObject.scale, animationObject.scale, 1);\r\n\t            mesh.material.opacity = animationObject.opacity;\r\n\t        }).then(function () {\r\n\t            _this.setInitialState();\r\n\t        });\r\n\t    };\r\n\t    TrendBeacon.prototype.setInitialState = function () {\r\n\t        this.mesh.scale.set(0.2, 0.2, 1);\r\n\t        this.mesh.material.opacity = 1;\r\n\t    };\r\n\t    TrendBeacon.prototype.onDestroy = function () {\r\n\t        _super.prototype.onDestroy.call(this);\r\n\t        if (this.animation)\r\n\t            this.animation.stop();\r\n\t    };\r\n\t    TrendBeacon.createTexture = function () {\r\n\t        var h = 32, w = 32;\r\n\t        return three_charts_1.Utils.createTexture(h, w, function (ctx) {\r\n\t            ctx.beginPath();\r\n\t            ctx.arc(w / 2, h / 2, w / 2, 0, 2 * Math.PI, false);\r\n\t            ctx.fillStyle = 'white';\r\n\t            ctx.fill();\r\n\t        });\r\n\t    };\r\n\t    TrendBeacon.prototype.onTransformationFrame = function () {\r\n\t        this.segment = this.trend.segmentsManager.getEndSegment();\r\n\t        this.updatePosition();\r\n\t    };\r\n\t    TrendBeacon.prototype.onSegmentsAnimate = function (trendsSegments) {\r\n\t        this.segment = trendsSegments.getEndSegment();\r\n\t        this.updatePosition();\r\n\t    };\r\n\t    TrendBeacon.prototype.updatePosition = function () {\r\n\t        var chart = this.chart;\r\n\t        var xVal, yVal;\r\n\t        var currentAnimationState = this.segment.currentAnimationState;\r\n\t        if (this.trend.getOptions().type == three_charts_1.TREND_TYPE.LINE) {\r\n\t            xVal = currentAnimationState.endXVal;\r\n\t            yVal = currentAnimationState.endYVal;\r\n\t        }\r\n\t        else {\r\n\t            xVal = currentAnimationState.xVal;\r\n\t            yVal = currentAnimationState.endYVal;\r\n\t        }\r\n\t        var endPointVector = chart.screen.getPointOnChart(xVal, yVal);\r\n\t        var screenWidth = chart.state.width;\r\n\t        var x = endPointVector.x;\r\n\t        var screenX = chart.screen.getScreenXByPoint(endPointVector.x);\r\n\t        if (screenX < 0) {\r\n\t            x = chart.screen.getPointByScreenX(0);\r\n\t        }\r\n\t        if (screenX > screenWidth)\r\n\t            x = chart.screen.getPointByScreenX(screenWidth);\r\n\t        this.mesh.position.set(x, endPointVector.y, 0.1);\r\n\t    };\r\n\t    return TrendBeacon;\r\n\t}(three_charts_1.TrendWidget));\r\n\texports.TrendBeacon = TrendBeacon;\r\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** plugins/src/TrendsBeaconWidget/TrendsBeaconWidget.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 4b867252af44e1a8fdfc\n **/","export * from './TrendsBeaconWidget';\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/src/TrendsBeaconWidget/index.ts\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"three-charts\"\n ** module id = 2\n ** module chunks = 0 1 2 3 4 5\n **/","import Object3D = THREE.Object3D;\nimport Mesh = THREE.Mesh;\nimport PlaneBufferGeometry = THREE.PlaneBufferGeometry;\nimport MeshBasicMaterial = THREE.MeshBasicMaterial;\nimport Vector3 = THREE.Vector3;\n\nimport {\n\tUtils,\n\tChart,\n\tIChartState,\n\tTrendsWidget,\n\tTrendWidget,\n\tTrendSegment,\n\tTrendSegmentsManager,\n\tITrendOptions,\n\tAnimation,\n\tTREND_TYPE\n} from 'three-charts';\n\nconst ANIMATION_TIME = 1000;\nconst ANIMATION_DELAY = 300;\n\n/**\n * widget adds blinking beacon on trends end\n * activated when trend.hasBeacon = true\n */\nexport class TrendsBeaconWidget extends TrendsWidget<TrendBeacon> {\n\tstatic widgetName = 'TrendsBeacon';\n\n\tprotected getTrendWidgetClass() {\n\t\treturn TrendBeacon;\n\t}\n}\n\nexport class TrendBeacon extends TrendWidget {\n\tprivate mesh: Mesh;\n\tprivate animated: boolean;\n\tprivate segment: TrendSegment;\n\tprivate animation: Animation<any>;\n\n\tstatic widgetIsEnabled(trendOptions: ITrendOptions) {\n\t\treturn trendOptions.enabled && trendOptions.hasBeacon && trendOptions.type == TREND_TYPE.LINE;\n\t}\n\n\tconstructor(chart: Chart, trendName: string) {\n\t\tsuper(chart, trendName);\n\n\t\tthis.initObject();\n\t\tthis.updatePosition();\n\t}\n\n\tgetObject3D() {\n\t\treturn this.mesh;\n\t}\n\n\tonTrendChange() {\n\t\tthis.updatePosition();\n\t\tthis.animate();\n\t}\n\n\tprotected bindEvents() {\n\t\tsuper.bindEvents();\n\t\tthis.bindEvent(this.chart.onScroll(() => this.updatePosition()));\n\t}\n\n\tprivate initObject() {\n\n\t\t// add beacon\n\t\tlet light = this.mesh = new Mesh(\n\t\t\tnew PlaneBufferGeometry(32, 32),\n\t\t\tnew MeshBasicMaterial({map: TrendBeacon.createTexture(), transparent: true})\n\t\t);\n\n\t\tthis.setInitialState();\n\n\t\t// add dot\n\t\tlight.add(new Mesh(\n\t\t\tnew PlaneBufferGeometry(5, 5),\n\t\t\tnew MeshBasicMaterial({map: TrendBeacon.createTexture()})\n\t\t));\n\n\t\tthis.segment = this.trend.segmentsManager.getEndSegment();\n\t}\n\n\tprivate animate() {\n\t\tif (!this.chart.state.animations.enabled) return;\n\n\t\tif (this.animation) this.animation.stop();\n\t\tthis.setInitialState();\n\n\t\tlet mesh = this.mesh;\n\t\tlet animationObject = {\n\t\t\tscale: mesh.scale.x,\n\t\t\topacity: mesh.material.opacity\n\t\t};\n\n\t\tthis.animation = this.chart.animationManager\n\t\t\t.animate(ANIMATION_TIME)\n\t\t\t.withDelay(ANIMATION_DELAY)\n\t\t\t.from(animationObject)\n\t\t\t.to({scale: 1, opacity: 0})\n\t\t\t.onTick(animationObject => {\n\t\t\t\tmesh.scale.set(animationObject.scale, animationObject.scale, 1);\n\t\t\t\tmesh.material.opacity = animationObject.opacity\n\t\t\t}).then(() => {\n\t\t\t\tthis.setInitialState();\n\t\t\t});\n\t}\n\n\tprivate setInitialState() {\n\t\tthis.mesh.scale.set(0.2, 0.2, 1);\n\t\tthis.mesh.material.opacity = 1;\n\t}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t\tif (this.animation) this.animation.stop();\n\t}\n\n\n\tprivate static createTexture() {\n\t\tvar h = 32, w = 32;\n\t\treturn Utils.createTexture(h, w, (ctx: CanvasRenderingContext2D) => {\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(w / 2, h / 2, w / 2, 0, 2 * Math.PI, false);\n\t\t\tctx.fillStyle = 'white';\n\t\t\tctx.fill();\n\t\t});\n\t}\n\n\tprotected onTransformationFrame() {\n\t\tthis.segment = this.trend.segmentsManager.getEndSegment();\n\t\tthis.updatePosition();\n\t}\n\n\tprotected onSegmentsAnimate(trendsSegments: TrendSegmentsManager) {\n\t\tthis.segment = trendsSegments.getEndSegment();\n\t\tthis.updatePosition();\n\t}\n\n\tprivate updatePosition() {\n\t\tvar chart = this.chart;\n\t\tvar xVal: number, yVal: number;\n\t\tvar currentAnimationState = this.segment.currentAnimationState;\n\t\tif (this.trend.getOptions().type == TREND_TYPE.LINE) {\n\t\t\txVal = currentAnimationState.endXVal;\n\t\t\tyVal = currentAnimationState.endYVal;\n\t\t} else {\n\t\t\txVal = currentAnimationState.xVal;\n\t\t\tyVal = currentAnimationState.endYVal;\n\t\t}\n\t\tvar endPointVector = chart.screen.getPointOnChart(xVal, yVal);\n\t\tvar screenWidth = chart.state.width;\n\t\tvar x = endPointVector.x;\n\t\tvar screenX = chart.screen.getScreenXByPoint(endPointVector.x);\n\t\tif (screenX < 0) {\n\t\t\tx = chart.screen.getPointByScreenX(0);\n\t\t}\n\t\tif (screenX > screenWidth) x = chart.screen.getPointByScreenX(screenWidth);\n\t\tthis.mesh.position.set(x, endPointVector.y, 0.1);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/src/TrendsBeaconWidget/TrendsBeaconWidget.ts\n **/"],"sourceRoot":""}